/**
 * @file    ov2640_regs.h
 * @brief   OV2640 register definitions and initialization tables
 */

#ifndef OV2640_REGS_H
#define OV2640_REGS_H

#include <stdint.h>

/* ---------- OV2640 Register Bank Select ---------------------------------- */
#define OV2640_DSP_RA_DLMT      0xFF
#define OV2640_SENSOR_BANK      0x01
#define OV2640_DSP_BANK         0x00

/* ---------- Sensor registers (bank 1) ------------------------------------ */
#define OV2640_SENSOR_COM7      0x12
#define OV2640_SENSOR_COM10     0x15
#define OV2640_SENSOR_HREFST    0x17
#define OV2640_SENSOR_HREFEND   0x18
#define OV2640_SENSOR_VSTRT     0x19
#define OV2640_SENSOR_VEND      0x1A
#define OV2640_SENSOR_MIDH      0x1C
#define OV2640_SENSOR_MIDL      0x1D
#define OV2640_SENSOR_AEC       0x10
#define OV2640_SENSOR_CLKRC     0x11
#define OV2640_SENSOR_PIDH      0x0A
#define OV2640_SENSOR_PIDL      0x0B
#define OV2640_SENSOR_COM3      0x0C
#define OV2640_SENSOR_REG04     0x04

/* ---------- DSP registers (bank 0) --------------------------------------- */
#define OV2640_DSP_RESET        0xE0
#define OV2640_DSP_MC_BIST      0xF9
#define OV2640_DSP_MC_AL        0xFA
#define OV2640_DSP_MC_AH        0xFB
#define OV2640_DSP_MC_D         0xFC
#define OV2640_DSP_P_CMD        0xFD
#define OV2640_DSP_P_STATUS     0xFE
#define OV2640_DSP_IMAGE_MODE   0xDA
#define OV2640_DSP_CTRL0        0xC2
#define OV2640_DSP_CTRL2        0x86
#define OV2640_DSP_CTRL3        0x87
#define OV2640_DSP_SIZEL        0x52
#define OV2640_DSP_HSIZE8       0xC0
#define OV2640_DSP_VSIZE8       0xC1
#define OV2640_DSP_CTRL1        0xC3
#define OV2640_DSP_R_DVP_SP     0xD3
#define OV2640_DSP_ZMOW         0x5A
#define OV2640_DSP_ZMOH         0x5B
#define OV2640_DSP_ZMHH         0x5C
#define OV2640_DSP_BPADDR       0x7C
#define OV2640_DSP_BPDATA       0x7D
#define OV2640_DSP_QS           0x44
#define OV2640_DSP_SS_ID        0x7F
#define OV2640_DSP_SS_CTRL      0x7E
#define OV2640_DSP_MC_D         0xFC

/* ---------- End-of-table marker ------------------------------------------ */
#define OV2640_REG_END          0xFF
#define OV2640_VAL_END          0xFF

/* ---------- Register pair type ------------------------------------------- */
typedef struct {
    uint8_t reg;
    uint8_t val;
} OV2640_RegPair;

/* ---------- OV2640 Reset (software reset) -------------------------------- */
static const OV2640_RegPair ov2640_reset_regs[] = {
    { OV2640_DSP_RA_DLMT, OV2640_SENSOR_BANK },
    { OV2640_SENSOR_COM7, 0x80 }, /* SCCB reset */
    { OV2640_REG_END,     OV2640_VAL_END },
};

/* ---------- OV2640 JPEG init --------------------------------------------- */
static const OV2640_RegPair ov2640_jpeg_init[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xDA, 0x18 },
    { 0xD7, 0x03 },
    { 0xE1, 0x77 },
    { 0xE5, 0x1F },
    { 0xD9, 0x10 },
    { 0xDF, 0x80 },
    { 0x33, 0x80 },
    { 0x3C, 0x10 },
    { 0xEB, 0x30 },
    { 0xDD, 0x7F },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* ---------- OV2640 YUV422 / RGB565 init ---------------------------------- */
static const OV2640_RegPair ov2640_yuv422_init[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xDA, 0x09 },  /* Image mode: RGB565 byte swap */
    { 0xD7, 0x03 },
    { 0xE1, 0x77 },
    { 0xE5, 0x1F },
    { 0xD9, 0x10 },
    { 0xDF, 0x80 },
    { 0x33, 0x80 },
    { 0x3C, 0x10 },
    { 0xEB, 0x30 },
    { 0xDD, 0x7F },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* ---------- OV2640 Sensor init (common for all modes) -------------------- */
static const OV2640_RegPair ov2640_sensor_init[] = {
    { OV2640_DSP_RA_DLMT, OV2640_SENSOR_BANK },
    { 0x11, 0x00 }, /* CLKRC: no prescaler */
    { 0x09, 0x02 },
    { 0x04, 0xA8 },
    { 0x13, 0xE5 },
    { 0x14, 0x48 },
    { 0x2C, 0x0C },
    { 0x33, 0x78 },
    { 0x3A, 0x33 },
    { 0x3B, 0xFB },
    { 0x3E, 0x00 },
    { 0x43, 0x11 },
    { 0x16, 0x10 },
    { 0x39, 0x92 },
    { 0x35, 0xDA },
    { 0x22, 0x1A },
    { 0x37, 0xC3 },
    { 0x23, 0x00 },
    { 0x34, 0xC0 },
    { 0x36, 0x1A },
    { 0x06, 0x88 },
    { 0x07, 0xC0 },
    { 0x0D, 0x87 },
    { 0x0E, 0x41 },
    { 0x4C, 0x00 },
    { 0x48, 0x00 },
    { 0x5B, 0x00 },
    { 0x42, 0x03 },
    { 0x4A, 0x81 },
    { 0x21, 0x99 },
    { 0x24, 0x40 },
    { 0x25, 0x38 },
    { 0x26, 0x82 },
    { 0x5C, 0x00 },
    { 0x63, 0x00 },
    { 0x46, 0x00 },
    { 0x0C, 0x3C },
    { 0x61, 0x70 },
    { 0x62, 0x80 },
    { 0x7C, 0x05 },
    { 0x20, 0x80 },
    { 0x28, 0x30 },
    { 0x6C, 0x00 },
    { 0x6D, 0x80 },
    { 0x6E, 0x00 },
    { 0x70, 0x02 },
    { 0x71, 0x94 },
    { 0x73, 0xC1 },
    { 0x3D, 0x34 },
    { 0x5A, 0x57 },
    { 0x12, 0x00 }, /* COM7: no reset */
    { 0x17, 0x11 },
    { 0x18, 0x75 },
    { 0x19, 0x01 },
    { 0x1A, 0x97 },
    { 0x32, 0x36 },
    { 0x03, 0x0F },
    { 0x37, 0x40 },
    { 0x4F, 0xBB },
    { 0x50, 0x9C },
    { 0x5A, 0x57 },
    { 0x6D, 0x80 },
    { 0x6D, 0x38 },
    { 0x39, 0x02 },
    { 0x35, 0x88 },
    { 0x22, 0x0A },
    { 0x37, 0x40 },
    { 0x23, 0x00 },
    { 0x34, 0xA0 },
    { 0x36, 0x1A },
    { 0x06, 0x02 },
    { 0x07, 0xC0 },
    { 0x0D, 0xB7 },
    { 0x0E, 0x01 },
    { 0x4C, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* ---------- DSP init (common) -------------------------------------------- */
static const OV2640_RegPair ov2640_dsp_init[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0x2C, 0xFF },
    { 0x2E, 0xDF },
    { 0x87, 0x10 },
    { 0x88, 0x00 },
    { 0xD7, 0x03 },
    { 0xD9, 0x10 },
    { 0xD3, 0x82 },
    { 0xC8, 0x08 },
    { 0xC9, 0x80 },
    { 0x7C, 0x00 },
    { 0x7D, 0x00 },
    { 0x7C, 0x03 },
    { 0x7D, 0x48 },
    { 0x7D, 0x48 },
    { 0x7C, 0x08 },
    { 0x7D, 0x20 },
    { 0x7D, 0x10 },
    { 0x7D, 0x0E },
    { 0x90, 0x00 },
    { 0x91, 0x0E },
    { 0x91, 0x1A },
    { 0x91, 0x31 },
    { 0x91, 0x5A },
    { 0x91, 0x69 },
    { 0x91, 0x75 },
    { 0x91, 0x7E },
    { 0x91, 0x88 },
    { 0x91, 0x8F },
    { 0x91, 0x96 },
    { 0x91, 0xA3 },
    { 0x91, 0xAF },
    { 0x91, 0xC4 },
    { 0x91, 0xD7 },
    { 0x91, 0xE8 },
    { 0x91, 0x20 },
    { 0x92, 0x00 },
    { 0x93, 0x06 },
    { 0x93, 0xE3 },
    { 0x93, 0x05 },
    { 0x93, 0x05 },
    { 0x93, 0x00 },
    { 0x93, 0x04 },
    { 0x93, 0x00 },
    { 0x93, 0x00 },
    { 0x93, 0x00 },
    { 0x93, 0x00 },
    { 0x93, 0x00 },
    { 0x93, 0x00 },
    { 0x93, 0x00 },
    { 0x96, 0x00 },
    { 0x97, 0x08 },
    { 0x97, 0x19 },
    { 0x97, 0x02 },
    { 0x97, 0x0C },
    { 0x97, 0x24 },
    { 0x97, 0x30 },
    { 0x97, 0x28 },
    { 0x97, 0x26 },
    { 0x97, 0x02 },
    { 0x97, 0x98 },
    { 0x97, 0x80 },
    { 0x97, 0x00 },
    { 0x97, 0x00 },
    { 0xA4, 0x00 },
    { 0xA8, 0x00 },
    { 0xC5, 0x11 },
    { 0xC6, 0x51 },
    { 0xBF, 0x80 },
    { 0xC7, 0x10 },
    { 0xB6, 0x66 },
    { 0xB8, 0xA5 },
    { 0xB7, 0x64 },
    { 0xB9, 0x7C },
    { 0xB3, 0xAF },
    { 0xB4, 0x97 },
    { 0xB5, 0xFF },
    { 0xB0, 0xC5 },
    { 0xB1, 0x94 },
    { 0xB2, 0x0F },
    { 0xC4, 0x5C },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* ---------- Resolution tables -------------------------------------------- */

/* QQVGA 160x120 */
static const OV2640_RegPair ov2640_qqvga[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xC0, 0xC8 }, { 0xC1, 0x96 },
    { 0x86, 0x3D },
    { 0x50, 0x89 }, { 0x51, 0x90 },
    { 0x52, 0x2C }, { 0x53, 0x00 },
    { 0x54, 0x00 }, { 0x55, 0x88 },
    { 0x5A, 0x28 }, { 0x5B, 0x1E },
    { 0x5C, 0x00 },
    { 0xD3, 0x04 },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* QVGA 320x240 */
static const OV2640_RegPair ov2640_qvga[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xC0, 0xC8 }, { 0xC1, 0x96 },
    { 0x86, 0x3D },
    { 0x50, 0x89 }, { 0x51, 0x90 },
    { 0x52, 0x2C }, { 0x53, 0x00 },
    { 0x54, 0x00 }, { 0x55, 0x88 },
    { 0x5A, 0x50 }, { 0x5B, 0x3C },
    { 0x5C, 0x00 },
    { 0xD3, 0x04 },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* VGA 640x480 */
static const OV2640_RegPair ov2640_vga[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xC0, 0xC8 }, { 0xC1, 0x96 },
    { 0x86, 0x3D },
    { 0x50, 0x89 }, { 0x51, 0x90 },
    { 0x52, 0x2C }, { 0x53, 0x00 },
    { 0x54, 0x00 }, { 0x55, 0x88 },
    { 0x5A, 0xA0 }, { 0x5B, 0x78 },
    { 0x5C, 0x00 },
    { 0xD3, 0x02 },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* SVGA 800x600 */
static const OV2640_RegPair ov2640_svga[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xC0, 0xC8 }, { 0xC1, 0x96 },
    { 0x86, 0x3D },
    { 0x50, 0x89 }, { 0x51, 0x90 },
    { 0x52, 0x2C }, { 0x53, 0x00 },
    { 0x54, 0x00 }, { 0x55, 0x88 },
    { 0x5A, 0xC8 }, { 0x5B, 0x96 },
    { 0x5C, 0x00 },
    { 0xD3, 0x02 },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* XGA 1024x768 */
static const OV2640_RegPair ov2640_xga[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xC0, 0xC8 }, { 0xC1, 0x96 },
    { 0x86, 0x3D },
    { 0x50, 0x00 }, { 0x51, 0x90 },
    { 0x52, 0x2C }, { 0x53, 0x00 },
    { 0x54, 0x00 }, { 0x55, 0x88 },
    { 0x5A, 0x00 }, { 0x5B, 0xC0 },
    { 0x5C, 0x01 },
    { 0xD3, 0x02 },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* SXGA 1280x1024 */
static const OV2640_RegPair ov2640_sxga[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xC0, 0xC8 }, { 0xC1, 0x96 },
    { 0x86, 0x3D },
    { 0x50, 0x00 }, { 0x51, 0x90 },
    { 0x52, 0x2C }, { 0x53, 0x00 },
    { 0x54, 0x00 }, { 0x55, 0x88 },
    { 0x5A, 0x40 }, { 0x5B, 0x00 },
    { 0x5C, 0x05 },
    { 0xD3, 0x02 },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

/* UXGA 1600x1200 */
static const OV2640_RegPair ov2640_uxga[] = {
    { OV2640_DSP_RA_DLMT, OV2640_DSP_BANK },
    { 0xE0, 0x04 },
    { 0xC0, 0xC8 }, { 0xC1, 0x96 },
    { 0x86, 0x3D },
    { 0x50, 0x00 }, { 0x51, 0x90 },
    { 0x52, 0x2C }, { 0x53, 0x00 },
    { 0x54, 0x00 }, { 0x55, 0x88 },
    { 0x5A, 0x90 }, { 0x5B, 0x2C },
    { 0x5C, 0x05 },
    { 0xD3, 0x02 },
    { 0xE0, 0x00 },
    { OV2640_REG_END, OV2640_VAL_END },
};

#endif /* OV2640_REGS_H */
